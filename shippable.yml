language: node_js

node_js:
  - "0.10"

addons:
  firefox: "19.0"

services:
  - selenium

env:
  global:
    - WWW_URL: http://104.236.198.94:40280/
    - secure: NvtFqfp2CrM1S5m2TLzhEmqVdruY0ithwONUPL9Y9UixsCUQi+5JfP3LzYDuOS1OeVsESxrDmxhtbNx45yzCrn/R9dLysflQleAiM0vTQ6eWZUZmfT0RGC9YZ6FTkp7J6+Ejc4SjgZNhUaf+xNuAD4m3HUxScpg3ovM+s7pkoZCIKAUPuYt4l4HRnz/4tqruCy29aHGPv7IjyB3Us3whPbeviwsxIhXYoUyow86ZLh4fkYY+BVSNbfbm+EknnMmrxr5P+6NRnMt82xrAadUXpvUp40mUhE9IjgVzELGTcOgebPRX0lNPR6bUrjouMddkp/N6Q5BAzjMYFmcxX7nkNg==
    # TOKEN is a GitHub token for the subscription triggering the build

install:
  - npm install -g istanbul
  - npm install -g protractor
  - npm install jasmine-reporters@1.0.0

before_script:
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage
  - "export DISPLAY=:99.0"
  - "/etc/init.d/xvfb start"

script:
  - protractor --version
  - protractor conf.js

after_script:
  - "/etc/init.d/xvfb stop"
  - istanbul cover conf.js -- -u tdd
  - istanbul report cobertura --dir  shippable/codecoverage/
